p
p <- plot_richness(ps_2_genus, x="Group", measures=c("Fisher")) +
geom_violin(aes(color = Group), trim = FALSE) +
geom_boxplot(width = 0.2) +
geom_point(aes(color = Group)) +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "**")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="**",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
p <- plot_richness(ps_2_genus, x="Group", measures=c("Fisher")) +
geom_violin(aes(color = Group), trim = FALSE) +
geom_boxplot(width = 0.2) +
geom_point(aes(color = Group)) +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "**")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="**",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
newSTorder = c("ctr", "ctr+rif", "ccl4", "ccl4+rif")
p$data$Group <- as.character(p$data$Group)
p$data$Group <- factor(p$data$Group, levels=newSTorder)
p
plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " * ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
p <- plot_richness(ps_2_genus, x="Group", measures=c("Fisher")) +
geom_violin(aes(color = Group), trim = FALSE) +
geom_boxplot(width = 0.2) +
geom_point(aes(color = Group)) +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "**")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="**",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
newSTorder = c("ctr", "ctr+rif", "ccl4", "ccl4+rif")
p$data$Group <- as.character(p$data$Group)
p$data$Group <- factor(p$data$Group, levels=newSTorder)
p
plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() + theme(axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " * ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " * ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " * ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
pObserved <- plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " * ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
pObserved$data$Group <- as.character(pObserved$data$Group)
pObserved$data$Group <- factor(pObserved$data$Group, levels=newSTorder)
pObserved
pObserved <- plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("*", " NS ", "NS")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
pObserved$data$Group <- as.character(pObserved$data$Group)
pObserved$data$Group <- factor(pObserved$data$Group, levels=newSTorder)
pObserved
## pairwise test with Wilcoxon rank-sum test, corrected by FDR method.
rich = estimate_richness(ps_2_genus, measures = c("Observed", "Chao1","Shannon", "Fisher"))
wilcox.observed <- pairwise.wilcox.test(rich$Observed,
sample_data(ps_2_genus)$Group,
p.adjust.method = "BH")
wilcox.observed
tab.observed <- wilcox.observed$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.observed
pObserved <- plot_richness(ps_2_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", "*")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
pObserved$data$Group <- as.character(pObserved$data$Group)
pObserved$data$Group <- factor(pObserved$data$Group, levels=newSTorder)
pObserved
pShannon <- plot_richness(ps_2_genus, x="Group", measures=c("Shannon")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(3.05, 3.13, 3.21), annotation=c("  NS  ", "NS", " NS ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation))
pShannon$data$Group <- as.character(pShannon$data$Group)
pShannon$data$Group <- factor(pShannon$data$Group, levels=newSTorder)
pShannon
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_2_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
pChao <- plot_richness(ps_2_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", "NS", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
pChao <- plot_richness(ps_2_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", "NS", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
pChao <- plot_richness(ps_2_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
pFisher <- plot_richness(ps_2_genus, x="Group", measures=c("Fisher")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "**")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="**",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
newSTorder = c("ctr", "ctr+rif", "ccl4", "ccl4+rif")
pFisher$data$Group <- as.character(pFisher$data$Group)
pFisher$data$Group <- factor(pFisher$data$Group, levels=newSTorder)
pFisher
tab.fisher
rich = estimate_richness(ps_raref_genus, measures = c("Observed", "Chao1","Shannon", "Fisher"))
wilcox.observed <- pairwise.wilcox.test(rich$Observed,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.observed
tab.observed <- wilcox.observed$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.observed
#Observed
pObserved <- plot_richness(ps_raref_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", "*")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pObserved$data$Group <- as.character(pObserved$data$Group)
pObserved$data$Group <- factor(pObserved$data$Group, levels=newSTorder)
pObserved
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Lo mismo pero usando el índice Chao1
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
#Lo mismo pero usando el índice Fisher
wilcox.fisher <- pairwise.wilcox.test(rich$Fisher,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.fisher
tab.fisher <- wilcox.fisher$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.fisher
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Lo mismo pero usando el índice Chao1
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
#Lo mismo pero usando el índice Fisher
wilcox.fisher <- pairwise.wilcox.test(rich$Fisher,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.fisher
tab.fisher <- wilcox.fisher$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.fisher
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Shannon
pShannon <- plot_richness(ps_raref_genus, x="Group", measures=c("Shannon")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(3.05, 3.13, 3.21), annotation=c("  NS  ", "NS", " NS ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation))
#Re-arranging the order of the figure, controls first
pShannon$data$Group <- as.character(pShannon$data$Group)
pShannon$data$Group <- factor(pShannon$data$Group, levels=newSTorder)
pShannon
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Lo mismo pero usando el índice Chao1
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
#Chao1
pChao <- plot_richness(ps_raref_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Lo mismo pero usando el índice Chao1
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
pChao <- plot_richness(ps_raref_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
wilcox.shannon
tab.shannon <- wilcox.shannon$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.shannon
#Lo mismo pero usando el índice Chao1
wilcox.chao <- pairwise.wilcox.test(rich$Chao1,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.chao
tab.chao <- wilcox.chao$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.chao
#Lo mismo pero usando el índice Fisher
wilcox.fisher <- pairwise.wilcox.test(rich$Fisher,
sample_data(ps_raref_genus)$Group,
p.adjust.method = "BH")
wilcox.fisher
tab.fisher <- wilcox.fisher$p.value %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "group1") %>%
gather(key="group2", value="p.adj", -group1) %>%
na.omit()
tab.fisher
pFisher <- plot_richness(ps_raref_genus, x="Group", measures=c("Fisher")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "*")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
newSTorder = c("ctr", "ctr+rif", "ccl4", "ccl4+rif")
pFisher$data$Group <- as.character(pFisher$data$Group)
pFisher$data$Group <- factor(pFisher$data$Group, levels=newSTorder)
pFisher
library(ggsignif)
#Observed
pObserved <- plot_richness(ps_raref_genus, x="Group", measures=c("Observed")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", "*")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 86, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pObserved$data$Group <- as.character(pObserved$data$Group)
pObserved$data$Group <- factor(pObserved$data$Group, levels=newSTorder)
pObserved
#Shannon
pShannon <- plot_richness(ps_raref_genus, x="Group", measures=c("Shannon")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(3.05, 3.13, 3.21), annotation=c("  NS  ", "NS", " NS ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation))
#Re-arranging the order of the figure, controls first
pShannon$data$Group <- as.character(pShannon$data$Group)
pShannon$data$Group <- factor(pShannon$data$Group, levels=newSTorder)
pShannon
#Chao1
pChao <- plot_richness(ps_raref_genus, x="Group", measures=c("Chao1")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90), axis.text.x = element_text(size = 16)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(78, 80, 82), annotation=c("NS", " NS ", " * ")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="**",
y_position = 84, tip_length = 0, vjust=0.4)
#Re-arranging the order of the figure, controls first
pChao$data$Group <- as.character(pChao$data$Group)
pChao$data$Group <- factor(pChao$data$Group, levels=newSTorder)
pChao
#Fisher
pFisher <- plot_richness(ps_raref_genus, x="Group", measures=c("Fisher")) +
geom_boxplot() +
theme_classic() + theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90)) +
geom_signif(stat="identity",
data=data.frame(x=c(1, 2, 3), xend=c(2, 3, 4),
y=c(9.0, 9.20, 9.40), annotation=c("NS", " NS ", "*")),
aes(x=x,xend=xend, y=y, yend=y, annotation=annotation)) +
geom_signif(comparisons=list(c("ctr+rif", "ccl4+rif")), annotations="***",
y_position = 9.60, tip_length = 0, vjust=0.4) +
geom_signif(comparisons=list(c("ctr", "ccl4+rif")), annotations="*",
y_position = 9.80, tip_length = 0, vjust=0.4) + theme(
axis.text.x = element_text(size = 16), axis.title.y = element_text(size = 16))
newSTorder = c("ctr", "ctr+rif", "ccl4", "ccl4+rif")
pFisher$data$Group <- as.character(pFisher$data$Group)
pFisher$data$Group <- factor(pFisher$data$Group, levels=newSTorder)
pFisher
plot_richness(ps_2_genus, x="Group", measures=c("Observed", "Chao1", "Shannon", "Fisher")) +
geom_boxplot() +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90))
plot_richness(ps_raref_genus, x="Group", measures=c("Observed", "Chao1", "Shannon", "Fisher")) +
geom_boxplot() +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90))
plot_richness(ps_2, x="Group", measures=c("Observed", "Chao1", "Shannon", "Fisher")) +
geom_boxplot() +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90))
plot_richness(ps.rarefied.clean, x="Group", measures=c("Observed", "Chao1", "Shannon", "Fisher")) +
geom_boxplot() +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x.bottom = element_text(angle = -90))
